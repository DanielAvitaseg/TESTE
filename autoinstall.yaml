autoinstall:
  version: 1
  storage:
    wipe: all
    layout:
      name: lvm
      match:
        path: /dev/nvme0n1
      password: "Avita123"
  identity:
    hostname: daniel_sammartano
    username: testefinal
    password: "$6$Xc9ZK8EFQGdlONL9$IIQGMT/V0XpJZnRTMkcb34TawqgkyGinHgcHcnq0oGY.ReZgITF1uXxBSxyllNRRkTuq0fx4QAoIWqC/Un3iW/"
  locale: pt_BR
  timezone: America/Sao_Paulo
  keyboard:
    layout: br
  packages:
    - docker.io
    - apt-transport-https
    - ca-certificates
    - curl
    - gnupg
    - lsb-release
    - gimp
    - git
    - wget
  snaps:
    - name: spotify
      channel: stable
      classic: false
    - name: postman
      channel: stable
      classic: false
    - name: slack
      channel: stable
      classic: false
    - name: code
      channel: stable
      classic: true
    - name: dbeaver-ce
      channel: stable
      classic: false
    # Adicionando .NET Core SDK 8.0 via Snap para simplificar
    - name: dotnet-sdk
      channel: 8.0/stable
      classic: true
  codecs:
    install: true
  drivers:
    install: true
  updates: all
  late-commands:
    # 1. Atualização inicial (após a instalação base e dos snaps)
    - curtin in-target -- apt update
    - curtin in-target -- apt upgrade -y

    # 2. Instalação do NVM (Node Version Manager)
    # Apenas instala o NVM. O usuário deverá instalar o Node.js na primeira sessão.
    - curtin in-target -- su - testefinal -c 'curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.7/install.sh | bash'

    # 3. Configuração do Docker (adicionar usuário ao grupo docker)
    - curtin in-target -- usermod -aG docker testefinal
    
  power-state:
    delay: 5
    mode: reboot
